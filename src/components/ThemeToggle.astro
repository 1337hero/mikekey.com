---
import { Icon } from 'astro-icon/components';

export interface Props {
  class?: string;
  size?: number;
}

const { class: className = '', size = 42 } = Astro.props as Props;
---

<button
  id="theme-toggle"
  type="button"
  class={`inline-flex items-center justify-center rounded-lg bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700 transition-colors ${className}`}
  aria-label="Toggle theme"
>
  <Icon name="mdi:white-balance-sunny" size={size} class="p-2 block dark:hidden" aria-hidden="true" />
  <Icon name="mdi:weather-night" size={size} class="p-2 hidden dark:block" aria-hidden="true" />
</button>

<script>
  import { initThemeToggle } from '../scripts/theme';
  
  const schedule = (fn: () => void) => (
    'requestIdleCallback' in window ? window.requestIdleCallback(fn) : setTimeout(fn, 1)
  );
  
  schedule(initThemeToggle);
  document.addEventListener('astro:page-load', () => schedule(initThemeToggle));
</script>
